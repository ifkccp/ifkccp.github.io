<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title><![CDATA[架构人生]]></title>
  <subtitle><![CDATA[成长之路]]></subtitle>
  <link href="/atom.xml" rel="self"/>
  <link href="http://ls-la.me/"/>
  <updated>2015-03-24T07:49:58.000Z</updated>
  <id>http://ls-la.me/</id>
  
  <author>
    <name><![CDATA[我叫小井]]></name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title><![CDATA[Mac下设置VirtualBox的80端口转发]]></title>
    <link href="http://ls-la.me/2015/03/24/port-forwarding-for-virtualbox-on-mac/"/>
    <id>http://ls-la.me/2015/03/24/port-forwarding-for-virtualbox-on-mac/</id>
    <published>2015-03-24T06:21:42.000Z</published>
    <updated>2015-03-24T07:49:58.000Z</updated>
    <content type="html"><![CDATA[<p>Mac 抹盘装完 Yosemite 之后所有的开发环境全部都需要重新搭建，索性弄个虚拟机然后环境全部扔进去得了。反正机器本身没啥好备份的，以后再装系统就只备份虚拟机就行。</p>
<p>由于本身不是root用户，虚拟机的开不了80端口，需要在主机上做点配置 (VirtualBox已经把虚拟机的80端口转发到了Mac的8080端口)：</p>
<p><img src="http://ww3.sinaimg.cn/mw690/00651KUrgw1eqgud42grsj30gf02owf3.jpg" alt="VirtualBox"></p>
<p>开始：<br><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ sudo -i</span><br><span class="line"><span class="preprocessor"># echo "rdr pass on lo0 inet proto tcp from any to any port 80 -&gt; 127.0.0.1 port 8080" &gt; /etc/pf.anchors/vbox</span></span><br><span class="line"><span class="preprocessor"># vi /etc/pf.conf</span></span><br></pre></td></tr></table></figure></p>
<p>在文件尾添加下边两行:</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rdr-anchor <span class="string">"vbox"</span></span><br><span class="line"><span class="built_in">load</span> anchor <span class="string">"vbox"</span> <span class="built_in">from</span> <span class="string">"/etc/pf.anchors/vbox"</span></span><br></pre></td></tr></table></figure>
<p>使配置生效：<br><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor"># pfctl -ef /etc/pf.conf</span></span><br></pre></td></tr></table></figure></p>
<p>现在即可打开浏览器，不用加端口访问虚拟机里的web项目了。</p>
<p>添加开机启动需要编辑文件 <code>/System/Library/LaunchDaemons/com.apple.pfctl.plist</code>，添加第二行 (-e这一行)：</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="built_in">string</span>&gt;pfctl&lt;/<span class="built_in">string</span>&gt;</span><br><span class="line">&lt;<span class="built_in">string</span>&gt;-<span class="keyword">e</span>&lt;/<span class="built_in">string</span>&gt;</span><br><span class="line">&lt;<span class="built_in">string</span>&gt;-<span class="keyword">f</span>&lt;/<span class="built_in">string</span>&gt;</span><br><span class="line">&lt;<span class="built_in">string</span>&gt;/etc/pf.<span class="keyword">conf</span>&lt;/<span class="built_in">string</span>&gt;</span><br></pre></td></tr></table></figure>
<p>参考：<a href="http://rabbit52.com/2014/desktopos/mac/yosemite-port-forwarding-at-startup" target="_blank" rel="external">Yosemite 开机启动设置端口转发</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>Mac 抹盘装完 Yosemite 之后所有的开发环境全部都需要重新搭建，索性弄个虚拟机然后环境全部扔进去得了。反正机器本身没啥好备份的，以后再装系统就只备份虚拟机就行。</p>
<p>由于本身不是root用户，虚拟机的开不了80端口，需要在主机上做点配置 (Virtual]]>
    </summary>
    
      <category term="Mac" scheme="http://ls-la.me/tags/Mac/"/>
    
      <category term="Virtualbox" scheme="http://ls-la.me/tags/Virtualbox/"/>
    
      <category term="Mac" scheme="http://ls-la.me/categories/Mac/"/>
    
  </entry>
  
</feed>